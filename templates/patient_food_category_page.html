<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Choose Foods</title>
    {% extends 'patient_base.html' %}
    {% block content %} 
        <!-- Tabs -->
        <div class="pfc-tabs" role="tablist" aria-label="类别切换">
            <button class="pfc-tab" role="tab" aria-selected="true" aria-controls="pfc-panel-foods" id="pfc-tab-foods">Foods</button>
            <button class="pfc-tab" role="tab" aria-selected="false" aria-controls="pfc-panel-drugs" id="pfc-tab-drugs">Drugs</button>
        </div>

        <!-- Foods panel -->
        <section id="pfc-panel-foods" role="tabpanel" aria-labelledby="pfc-tab-foods">
            <ul class="pfc-list">
                {% if foods and foods|length > 0 %}
                {% for food in foods %}
                <li class="pfc-item" data-food-id="{{ food.id }}">
                    <div class="pfc-avatar" aria-hidden="true">{{ (food.description|default('?'))[:1]|upper }}</div>
                    <div class="pfc-title">{{ food.description|default('No name') }}</div>
                </li>
                {% endfor %}
                {% else %}
                <li class="pfc-item pfc-empty">
                    <div class="pfc-title">No food data</div>
                </li>
                {% endif %}
            </ul>

            <!-- Search -->
            <div class="pfc-search">
                <div class="pfc-search-leading" aria-hidden="true">
                    <img src="{{ url_for('static', filename='public/Search.png') }}" alt="">
                </div>
                <label for="pfc-search-input" class="sr-only">Search Foods</label>
                <div class="pfc-search-field">
                    <input id="pfc-search-input" class="pfc-search-input" type="search" placeholder="Enter to search foods" />
                </div>
            </div>
        </section>

        <!-- Drugs panel -->
        <section id="pfc-panel-drugs" role="tabpanel" aria-labelledby="pfc-tab-drugs" hidden>
            <ul class="pfc-list">
                {% if drugs and drugs|length > 0 %}
                {% for drug in drugs %}
                <li class="pfc-item" data-drug-ndc="{{ drug.product_ndc }}">
                    <div class="pfc-avatar" aria-hidden="true">{{ ((drug.brand_name or drug.generic_name)|default('?'))[:1]|upper }}</div>
                    <div class="pfc-title">{{ (drug.brand_name or drug.generic_name)|default('No name') }}</div>
                </li>
                {% endfor %}
                {% else %}
                <li class="pfc-item pfc-empty">
                    <div class="pfc-title">No drug data</div>
                </li>
                {% endif %}
            </ul>

            <div class="pfc-search">
                <div class="pfc-search-leading" aria-hidden="true">
                    <img src="{{ url_for('static', filename='public/Search.png') }}" alt="">
                </div>
                <label for="pfc-search-input" class="sr-only">Search Drugs</label>
                <div class="pfc-search-field">
                    <input id="pfc-search-input" class="pfc-search-input" type="search" placeholder="Enter to search drugs" />
                </div>
            </div>
        </section>
    <script>
        // 简单的 tab 切换（无依赖）
        (function(){
            const tabFoods = document.getElementById('pfc-tab-foods');
            const tabDrugs = document.getElementById('pfc-tab-drugs');
            const panelFoods = document.getElementById('pfc-panel-foods');
            const panelDrugs = document.getElementById('pfc-panel-drugs');

            function activate(tab){
                const isFoods = tab === tabFoods;
                tabFoods.classList.toggle('is-active', isFoods);
                tabDrugs.classList.toggle('is-active', !isFoods);
                tabFoods.setAttribute('aria-selected', String(isFoods));
                tabDrugs.setAttribute('aria-selected', String(!isFoods));
                panelFoods.hidden = !isFoods;
                panelDrugs.hidden = isFoods;
            }

            tabFoods.addEventListener('click', () => activate(tabFoods));
            tabDrugs.addEventListener('click', () => activate(tabDrugs));
        })();
    </script>
    {% endblock %}
</body>
</html>

